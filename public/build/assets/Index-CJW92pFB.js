import{m as L,r as n,j as e,S as z,L as M}from"./app-DMpQA86v.js";import{A as R}from"./AuthenticatedLayout-C7SyfY9Z.js";import{D as U,a as $,b as B,c as I,B as u}from"./dialog-CZCOUsV5.js";import{I as x}from"./input-DwJfKTdf.js";import{L as d}from"./label-FtF91ial.js";import{S as b}from"./select-CRV2jmID.js";import{f as O}from"./format-DF3zju1I.js";import{d as P,m as A,F as G,a as T,C as q}from"./ConfirmDialog-CUOnWxoa.js";import{F as Q}from"./PlusIcon-CRYNvhOB.js";import{F as H}from"./PencilIcon-VtQjBVAG.js";function J({isOpen:c,onClose:h,sediprano:t,mode:o,cargos:S,areas:w,carreras:v,generos:C}){const{data:l,setData:i,post:y,put:g,processing:F,errors:s,reset:m}=L({codigo:"",dni:"",primer_apellido:"",segundo_apellido:"",carrera_id:"",genero:"",celular:"",fecha_nacimiento:"",user_id:"",cargo_id:"",area_id:""}),[N,j]=n.useState([]),[D,f]=n.useState(!1),[p,_]=n.useState("");n.useEffect(()=>{p.length>=3?(f(!0),fetch(route("api.users.search",{query:p})).then(a=>a.json()).then(a=>{j(a),f(!1)})):j([])},[p]),n.useEffect(()=>{c&&o==="edit"&&t?(i({codigo:t.codigo.toString(),dni:t.dni||"",primer_apellido:t.primer_apellido,segundo_apellido:t.segundo_apellido,carrera_id:t.carrera_id?t.carrera_id.toString():"",genero:t.genero,celular:t.celular||"",fecha_nacimiento:t.fecha_nacimiento?O(new Date(t.fecha_nacimiento),"yyyy-MM-dd"):"",user_id:t.user_id.toString(),cargo_id:t.cargo_id.toString(),area_id:t.area_id?t.area_id.toString():""}),t.user&&j([t.user])):c&&o==="create"&&m()},[c,t,o]);const E=a=>{a.preventDefault(),o==="create"?y(route("sedipranos.store"),{onSuccess:()=>{m(),h()}}):g(route("sedipranos.update",t==null?void 0:t.id),{onSuccess:()=>{h()}})};return e.jsx(U,{open:c,onOpenChange:a=>!a&&h(),children:e.jsxs($,{className:"sm:max-w-[600px]",children:[e.jsx(B,{children:e.jsx(I,{children:o==="create"?"Nuevo Sediprano":"Editar Sediprano"})}),e.jsxs("form",{onSubmit:E,className:"mt-4 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(d,{htmlFor:"codigo",children:["Código ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(x,{id:"codigo",type:"number",value:l.codigo,onChange:a=>i("codigo",a.target.value),placeholder:"Ej: 20191234"}),s.codigo&&e.jsx("p",{className:"text-sm text-red-500",children:s.codigo})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"dni",children:"DNI"}),e.jsx(x,{id:"dni",value:l.dni,onChange:a=>i("dni",a.target.value),placeholder:"Ej: 12345678",maxLength:8}),s.dni&&e.jsx("p",{className:"text-sm text-red-500",children:s.dni})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(d,{htmlFor:"primer_apellido",children:["Primer Apellido ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(x,{id:"primer_apellido",value:l.primer_apellido,onChange:a=>i("primer_apellido",a.target.value),placeholder:"Ej: Pérez"}),s.primer_apellido&&e.jsx("p",{className:"text-sm text-red-500",children:s.primer_apellido})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(d,{htmlFor:"segundo_apellido",children:["Segundo Apellido ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(x,{id:"segundo_apellido",value:l.segundo_apellido,onChange:a=>i("segundo_apellido",a.target.value),placeholder:"Ej: Gómez"}),s.segundo_apellido&&e.jsx("p",{className:"text-sm text-red-500",children:s.segundo_apellido})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(d,{htmlFor:"genero",children:["Género ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(b,{id:"genero",value:l.genero,onChange:a=>i("genero",a.target.value),children:[e.jsx("option",{value:"",children:"Selecciona un género"}),C.map(a=>e.jsx("option",{value:a,children:a.charAt(0).toUpperCase()+a.slice(1)},a))]}),s.genero&&e.jsx("p",{className:"text-sm text-red-500",children:s.genero})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"celular",children:"Celular"}),e.jsx(x,{id:"celular",type:"tel",value:l.celular,onChange:a=>i("celular",a.target.value),placeholder:"Ej: 987654321",maxLength:9}),s.celular&&e.jsx("p",{className:"text-sm text-red-500",children:s.celular})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"fecha_nacimiento",children:"Fecha de Nacimiento"}),e.jsx(x,{id:"fecha_nacimiento",type:"date",value:l.fecha_nacimiento,onChange:a=>i("fecha_nacimiento",a.target.value)}),s.fecha_nacimiento&&e.jsx("p",{className:"text-sm text-red-500",children:s.fecha_nacimiento})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"carrera_id",children:"Carrera"}),e.jsxs(b,{id:"carrera_id",value:l.carrera_id,onChange:a=>i("carrera_id",a.target.value),children:[e.jsx("option",{value:"",children:"Selecciona una carrera"}),v.map(a=>e.jsx("option",{value:a.id,children:a.nombre},a.id))]}),s.carrera_id&&e.jsx("p",{className:"text-sm text-red-500",children:s.carrera_id})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(d,{htmlFor:"cargo_id",children:["Cargo ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(b,{id:"cargo_id",value:l.cargo_id,onChange:a=>i("cargo_id",a.target.value),children:[e.jsx("option",{value:"",children:"Selecciona un cargo"}),S.map(a=>e.jsx("option",{value:a.id,children:a.nombre},a.id))]}),s.cargo_id&&e.jsx("p",{className:"text-sm text-red-500",children:s.cargo_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"area_id",children:"Área"}),e.jsxs(b,{id:"area_id",value:l.area_id,onChange:a=>i("area_id",a.target.value),children:[e.jsx("option",{value:"",children:"Selecciona un área"}),w.map(a=>e.jsx("option",{value:a.id,children:a.nombre},a.id))]}),s.area_id&&e.jsx("p",{className:"text-sm text-red-500",children:s.area_id})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(d,{htmlFor:"user_id",children:["Usuario ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(x,{type:"text",placeholder:"Buscar usuario por nombre o email...",value:p,onChange:a=>_(a.target.value),className:"mb-2"}),D&&e.jsx("p",{className:"text-sm text-gray-500",children:"Buscando usuarios..."}),N.length>0&&e.jsx("div",{className:"mt-2 overflow-y-auto border rounded-md max-h-40",children:N.map(a=>e.jsxs("div",{className:`p-2 hover:bg-gray-100 cursor-pointer ${Number(l.user_id)===a.id?"bg-blue-50":""}`,onClick:()=>{i("user_id",a.id.toString()),_(a.name)},children:[e.jsx("div",{className:"font-medium",children:a.name}),e.jsx("div",{className:"text-sm text-gray-500",children:a.email})]},a.id))}),e.jsx("input",{type:"hidden",name:"user_id",value:l.user_id})]}),s.user_id&&e.jsx("p",{className:"text-sm text-red-500",children:s.user_id})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(u,{type:"button",variant:"outline",onClick:h,children:"Cancelar"}),e.jsx(u,{type:"submit",disabled:F,children:o==="create"?"Crear":"Actualizar"})]})]})]})})}function te({sedipranos:c,filters:h,cargos:t,areas:o,carreras:S,generos:w}){var a;const[v,C]=n.useState(h.search),[l,i]=n.useState(!1),[y,g]=n.useState(null),[F,s]=n.useState(!1),[m,N]=n.useState(null),{delete:j}=L({}),D=n.useCallback(P(r=>{z.get(route("sedipranos.index"),{search:r},{preserveState:!0,preserveScroll:!0})},300),[]),f=r=>{C(r.target.value),D(r.target.value)},p=r=>{z.get(route("sedipranos.index",{page:r}),{search:v},{preserveState:!0})},_=r=>{N(r),s(!0)},E=()=>{m&&j(route("sedipranos.destroy",m.id))};return e.jsxs(R,{children:[e.jsx(M,{title:"Sedipranos"}),e.jsxs("div",{className:"p-8",children:[e.jsxs(A.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Sedipranos"}),e.jsx("p",{className:"mt-1 text-gray-500",children:"Gestiona los miembros de SEDIPRO"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(x,{type:"search",placeholder:"Buscar sedipranos...",value:v,onChange:f,className:"w-[300px] pl-10"}),e.jsx(G,{className:"absolute w-5 h-5 text-gray-400 -translate-y-1/2 left-3 top-1/2"})]}),e.jsxs(u,{onClick:()=>{g(null),i(!0)},className:"gap-2",children:[e.jsx(Q,{className:"w-5 h-5"}),"Nuevo Sediprano"]})]})]}),e.jsxs(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mt-8 bg-white shadow-sm rounded-xl",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase",children:"Código"}),e.jsx("th",{className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase",children:"Nombre"}),e.jsx("th",{className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase",children:"Carrera"}),e.jsx("th",{className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase",children:"Cargo"}),e.jsx("th",{className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase",children:"Área"}),e.jsx("th",{className:"px-6 py-3 text-xs font-medium tracking-wider text-right text-gray-500 uppercase",children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.data.map((r,k)=>e.jsxs(A.tr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:k*.05},className:"hover:bg-gray-50/50",children:[e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 whitespace-nowrap",children:r.codigo}),e.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900 whitespace-nowrap",children:r.user.name}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 whitespace-nowrap",children:r.carrera?r.carrera.nombre:"—"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 whitespace-nowrap",children:r.cargo.nombre}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.area?e.jsx("span",{className:"inline-flex px-3 py-1 text-xs font-medium text-blue-800 bg-blue-100 rounded-full",children:r.area.abreviatura}):"—"}),e.jsxs("td",{className:"px-6 py-4 text-sm font-medium text-right whitespace-nowrap",children:[e.jsx(u,{onClick:()=>{g(r),i(!0)},variant:"ghost",className:"p-1 mr-2 bg-transparent hover:bg-blue-50 group",children:e.jsx(H,{className:"w-[18px] h-[18px] text-black group-hover:text-blue-600"})}),e.jsx(u,{onClick:()=>_(r),variant:"ghost",className:"p-1 mr-2 bg-transparent hover:bg-red-50 group",children:e.jsx(T,{className:"w-[18px] h-[18px] text-black group-hover:text-red-600"})})]})]},r.id))})]})}),c.last_page>1&&e.jsx("div",{className:"px-6 py-4 bg-white border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-gray-700",children:["Mostrando ",c.from," a ",c.to," de ",c.total," sedipranos"]}),e.jsx("div",{className:"flex gap-2",children:c.links.map((r,k)=>r.url===null?null:e.jsx(u,{onClick:()=>p(Number(r.label)),className:`${r.active?"bg-theme-azul border-theme-azul text-white hover:bg-theme-azul/90":"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50"} w-10 h-10 p-0 font-medium`,disabled:!r.url,children:r.label},k))})]})})]})]}),e.jsx(J,{isOpen:l,onClose:()=>{i(!1),g(null)},sediprano:y,mode:y?"edit":"create",cargos:t,areas:o,carreras:S,generos:w}),e.jsx(q,{isOpen:F,onClose:()=>s(!1),onConfirm:E,title:"Confirmar eliminación",message:`¿Estás seguro que deseas eliminar al sediprano ${(a=m==null?void 0:m.user)==null?void 0:a.name}? Esta acción no se puede deshacer.`})]})}export{te as default};
