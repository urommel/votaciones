import{m as k,r as m,j as e,S as D,L as A}from"./app-DMpQA86v.js";import{A as B}from"./AuthenticatedLayout-C7SyfY9Z.js";import{D as R,a as O,b as T,c as $,B as u}from"./dialog-CZCOUsV5.js";import{I as j}from"./input-DwJfKTdf.js";import{L as x}from"./label-FtF91ial.js";import{T as H}from"./textarea-COMWIroQ.js";import{S as q}from"./select-CRV2jmID.js";import{f as F}from"./format-DF3zju1I.js";import{d as I,m as E,F as L,a as z,C as P}from"./ConfirmDialog-CUOnWxoa.js";import{B as _}from"./badge-DAHxuvFS.js";import{F as G}from"./PlusIcon-CRYNvhOB.js";import{F as J}from"./PencilIcon-VtQjBVAG.js";import{e as U}from"./es-DWfJTDW_.js";function K({isOpen:n,onClose:p,votacion:t,mode:d,estados:f,eventos:y=[]}){const{data:c,setData:i,post:N,put:g,processing:w,errors:r,reset:o,clearErrors:v}=k({name:"",fecha:F(new Date,"yyyy-MM-dd"),hora_inicio:"08:00",hora_fin:"18:00",descripcion:"",estado:"pendiente",evento_requerido_id:""}),[b,h]=m.useState(null);m.useEffect(()=>{n&&d==="edit"&&t?(i({name:t.name,fecha:t.fecha,hora_inicio:t.hora_inicio,hora_fin:t.hora_fin,descripcion:t.descripcion||"",estado:t.estado,evento_requerido_id:t.evento_requerido_id?String(t.evento_requerido_id):""}),v(),h(null)):n&&d==="create"&&(o("name","descripcion"),i(a=>({...a,fecha:F(new Date,"yyyy-MM-dd"),hora_inicio:"08:00",hora_fin:"18:00",estado:"pendiente",evento_requerido_id:""})),v(),h(null))},[n,t,d]);const C=a=>{a.preventDefault(),h(null),d==="create"?N(route("votaciones.store"),{onSuccess:()=>{o(),p()},onError:l=>{console.error("Errores de validación:",l),l.error&&h(l.error)}}):g(route("votaciones.update",t==null?void 0:t.id),{onSuccess:()=>{p()},onError:l=>{console.error("Errores de validación:",l),l.error&&h(l.error)}})};return e.jsx(R,{open:n,onOpenChange:a=>!a&&p(),children:e.jsxs(O,{className:"sm:max-w-[550px]",children:[e.jsx(T,{children:e.jsx($,{children:d==="create"?"Nueva Votación":"Editar Votación"})}),b&&e.jsx("div",{className:"p-3 mb-4 text-sm text-red-800 bg-red-100 rounded-md",children:b}),e.jsxs("form",{onSubmit:C,className:"space-y-6 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"name",children:["Nombre ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(j,{id:"name",value:c.name,onChange:a=>i("name",a.target.value),placeholder:"Ej: Elección de Junta Directiva 2024"}),r.name&&e.jsx("p",{className:"text-sm text-red-500",children:r.name})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"fecha",children:["Fecha ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(j,{id:"fecha",type:"date",value:c.fecha,onChange:a=>i("fecha",a.target.value)}),r.fecha&&e.jsx("p",{className:"text-sm text-red-500",children:r.fecha})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"estado",children:["Estado ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(q,{id:"estado",value:c.estado,onChange:a=>i("estado",a.target.value),children:f.map(a=>e.jsx("option",{value:a,children:a.charAt(0).toUpperCase()+a.slice(1)},a))}),r.estado&&e.jsx("p",{className:"text-sm text-red-500",children:r.estado})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"hora_inicio",children:["Hora Inicio ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(j,{id:"hora_inicio",type:"time",value:c.hora_inicio,onChange:a=>i("hora_inicio",a.target.value)}),r.hora_inicio&&e.jsx("p",{className:"text-sm text-red-500",children:r.hora_inicio})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"hora_fin",children:["Hora Fin ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(j,{id:"hora_fin",type:"time",value:c.hora_fin,onChange:a=>i("hora_fin",a.target.value)}),r.hora_fin&&e.jsx("p",{className:"text-sm text-red-500",children:r.hora_fin})]})]}),y.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"evento_requerido_id",children:"Evento Requerido (Opcional)"}),e.jsxs(q,{id:"evento_requerido_id",value:c.evento_requerido_id,onChange:a=>i("evento_requerido_id",a.target.value),children:[e.jsx("option",{value:"",children:"Ninguno"}),y.map(a=>e.jsx("option",{value:a.id,children:a.nombre},a.id))]}),r.evento_requerido_id&&e.jsx("p",{className:"text-sm text-red-500",children:r.evento_requerido_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"descripcion",children:"Descripción"}),e.jsx(H,{id:"descripcion",value:c.descripcion,onChange:a=>i("descripcion",a.target.value),rows:3,placeholder:"Descripción de la votación..."}),r.descripcion&&e.jsx("p",{className:"text-sm text-red-500",children:r.descripcion})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(u,{type:"button",variant:"outline",onClick:p,children:"Cancelar"}),e.jsx(u,{type:"submit",disabled:w,variant:"default",className:"!bg-theme-rosa hover:!bg-theme-rosa/90",children:d==="create"?"Crear":"Actualizar"})]})]})]})})}function le({votaciones:n,filters:p,estados:t,eventos:d=[]}){const[f,y]=m.useState(p.search),[c,i]=m.useState(!1),[N,g]=m.useState(null),[w,r]=m.useState(!1),[o,v]=m.useState(null),{delete:b}=k({}),h=m.useCallback(I(s=>{D.get(route("votaciones.index"),{search:s},{preserveState:!0,preserveScroll:!0})},300),[]),C=s=>{y(s.target.value),h(s.target.value)},a=s=>{D.get(route("votaciones.index",{page:s}),{search:f},{preserveState:!0})},l=s=>{v(s),r(!0)},M=()=>{o&&b(route("votaciones.destroy",o.id))},V=s=>{switch(s){case"activa":return e.jsx(_,{className:"text-green-800 bg-green-100 border-green-200",children:"Activa"});case"pendiente":return e.jsx(_,{className:"text-yellow-800 bg-yellow-100 border-yellow-200",children:"Pendiente"});case"finalizada":return e.jsx(_,{className:"text-gray-800 bg-gray-100 border-gray-200",children:"Finalizada"});default:return e.jsx(_,{className:"text-gray-800 bg-gray-100",children:s})}};return e.jsxs(B,{children:[e.jsx(A,{title:"Votaciones"}),e.jsxs("div",{className:"p-8",children:[e.jsxs(E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Votaciones"}),e.jsx("p",{className:"mt-1 text-gray-500",children:"Gestiona las votaciones y elecciones"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(j,{type:"search",placeholder:"Buscar votaciones...",value:f,onChange:C,className:"w-[300px] pl-10"}),e.jsx(L,{className:"absolute w-5 h-5 text-gray-400 -translate-y-1/2 left-3 top-1/2"})]}),e.jsxs(u,{onClick:()=>{g(null),i(!0)},className:"gap-2 !bg-theme-rosa hover:!bg-theme-rosa/90",children:[e.jsx(G,{className:"w-5 h-5"}),"Nueva Votación"]})]})]}),e.jsxs(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mt-8 bg-white shadow-sm rounded-xl",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase",children:"Nombre"}),e.jsx("th",{className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase",children:"Fecha"}),e.jsx("th",{className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase",children:"Horario"}),e.jsx("th",{className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase",children:"Estado"}),e.jsx("th",{className:"px-6 py-3 text-xs font-medium tracking-wider text-right text-gray-500 uppercase",children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.data.map((s,S)=>e.jsxs(E.tr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:S*.05},className:"hover:bg-gray-50/50",children:[e.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900 whitespace-nowrap",children:s.name}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 whitespace-nowrap",children:F(new Date(s.fecha),"dd MMM yyyy",{locale:U})}),e.jsxs("td",{className:"px-6 py-4 text-sm text-gray-500 whitespace-nowrap",children:[s.hora_inicio," - ",s.hora_fin]}),e.jsx("td",{className:"px-6 py-4 text-sm whitespace-nowrap",children:V(s.estado)}),e.jsxs("td",{className:"px-6 py-4 text-sm font-medium text-right whitespace-nowrap",children:[e.jsx(u,{onClick:()=>{g(s),i(!0)},variant:"ghost",className:"p-1 mr-2 bg-transparent hover:bg-blue-50 group",children:e.jsx(J,{className:"w-[18px] h-[18px] text-black group-hover:text-blue-600"})}),e.jsx(u,{onClick:()=>l(s),variant:"ghost",className:"p-1 mr-2 bg-transparent hover:bg-red-50 group",children:e.jsx(z,{className:"w-[18px] h-[18px] text-black group-hover:text-red-600"})})]})]},s.id))})]})}),n.last_page>1&&e.jsx("div",{className:"px-6 py-4 bg-white border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-gray-700",children:["Mostrando ",n.from," a ",n.to," de ",n.total," votaciones"]}),e.jsx("div",{className:"flex gap-2",children:n.links.map((s,S)=>s.url===null?null:e.jsx(u,{onClick:()=>a(Number(s.label)),className:`${s.active?"bg-theme-rosa border-theme-rosa text-white hover:bg-theme-rosa/90":"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50"} w-10 h-10 p-0 font-medium`,disabled:!s.url,children:s.label},S))})]})})]})]}),e.jsx(K,{isOpen:c,onClose:()=>{i(!1),g(null)},votacion:N,mode:N?"edit":"create",estados:t,eventos:d}),e.jsx(P,{isOpen:w,onClose:()=>r(!1),onConfirm:M,title:"Confirmar eliminación",message:`¿Estás seguro que deseas eliminar la votación ${o==null?void 0:o.name}? Esta acción no se puede deshacer.`})]})}export{le as default};
